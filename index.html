<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#004D54">
    <title>2EMME | Prestige Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --c-ottanio: #004D54; --c-sugar: #FCF6BA; --glass-bg: rgba(255, 255, 255, 0.08); --glass-border: rgba(252, 246, 186, 0.2); --c-magenta: #DB4F61; }
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; background-color: #000; font-family: 'Plus Jakarta Sans', sans-serif; }
        .bg-layer { position: fixed; inset: 0; z-index: 0; background-size: cover; background-position: center top; transition: opacity 1s ease-in-out; opacity: 0; }
        .show-bg { opacity: 1 !important; }
        .bg-fusion { background-image: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8)), url('nyboston.jpg'); }
        .bg-nyc { background-image: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8)), url('ny.jpg'); }
        .bg-boston { background-image: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8)), url('boston.jpg'); }
        .glass-panel { background: var(--glass-bg); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 24px; padding: 20px; }
        .city-bg { position: absolute; left: 4px; top: 4px; bottom: 4px; width: calc(50% - 4px); background: var(--c-sugar); border-radius: 99px; transition: transform 0.4s; z-index: 1; }
        .city-btn.active { color: var(--c-ottanio); }
        .menu-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 12px 20px; background: rgba(0, 77, 84, 0.9); }
        .cat-chip { padding: 10px 4px; border-radius: 12px; border: 1px solid var(--glass-border); font-size: 8px; font-weight: 800; text-transform: uppercase; text-align: center; display: flex; flex-direction: column; align-items: center; gap: 4px; transition: 0.3s; }
        .cat-chip.selected { background: var(--c-sugar); color: var(--c-ottanio); }
        .route-card { border-left: 3px solid var(--c-sugar); background: rgba(252, 246, 186, 0.05); padding: 16px; margin-top: 12px; border-radius: 0 16px 16px 0; }
        .gold-text { font-family: 'Playfair Display', serif; background: linear-gradient(90deg, #BF953F, #FCF6BA, #B38728); -webkit-background-clip: text; color: transparent; }
        .bottle-container { position: relative; width: 100px; height: 250px; }
        .bottle-body { font-size: 120px; color: #2e4c26; transform: rotate(-15deg); filter: drop-shadow(0 0 20px #000); }
        .cork { position: absolute; top: 25px; left: 45px; width: 20px; height: 25px; background: #8B4513; border-radius: 4px; transform: rotate(-15deg); transition: all 0.5s ease; }
        .pop .cork { top: -200px; left: 200px; opacity: 0; }
        .shake { animation: shake 0.5s infinite; }
        @keyframes shake { 0%, 100% { transform: translate(0,0) rotate(-15deg); } 25% { transform: translate(-2px,2px) rotate(-15deg); } 75% { transform: translate(2px,-2px) rotate(-15deg); } }
    </style>
</head>
<body>

    <div id="layer-fusion" class="bg-layer bg-fusion show-bg"></div>
    <div id="layer-nyc" class="bg-layer bg-nyc"></div>
    <div id="layer-boston" class="bg-layer bg-boston"></div>

    <div id="bday-overlay" class="fixed inset-0 z-[10000] flex flex-col items-center justify-center bg-black transition-opacity duration-1000" style="display:none;">
        <div id="bottle-scene" class="bottle-container mb-8">
            <div class="cork"></div><i class="fa-solid fa-wine-bottle bottle-body"></i>
        </div>
        <div id="bday-msg" class="text-center opacity-0 transition-all duration-1000 transform translate-y-10 p-6">
            <h1 class="gold-text text-8xl font-bold leading-none">50</h1>
            <h2 class="gold-text text-3xl italic mb-10">Happy Birthday Giada</h2>
            <button onclick="exitBday()" class="px-12 py-4 bg-[#FCF6BA] text-[#004D54] font-bold rounded-full text-xs uppercase tracking-widest shadow-2xl">Entra nella Guida</button>
        </div>
        <button id="pop-btn" onclick="popBottle()" class="px-10 py-4 bg-white/10 border border-[#FCF6BA] text-[#FCF6BA] font-bold rounded-xl uppercase animate-pulse">Stappa üçæ</button>
    </div>

    <div id="main-app" class="relative z-10 h-screen flex flex-col">
        <header class="px-6 pt-10 pb-4 bg-gradient-to-b from-[#004D54] to-transparent">
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center gap-3 cursor-pointer" onclick="handleSecretClick()">
                    <div class="w-10 h-10 rounded-xl bg-[#FCF6BA] flex items-center justify-center text-[#004D54] shadow-lg"><i class="fa-solid fa-gem text-lg"></i></div>
                    <div><h1 class="text-lg font-black leading-none uppercase tracking-tighter">2EMME</h1><p class="text-[8px] text-[#FCF6BA] tracking-widest uppercase">Prestige Guide</p></div>
                </div>
            </div>
            <div class="relative bg-black/40 rounded-full p-1 flex border border-white/10">
                <div id="city-bg" class="city-bg"></div>
                <button onclick="changeCity('nyc')" id="btn-nyc" class="flex-1 city-btn py-2 text-[10px] font-bold z-10 active uppercase">New York</button>
                <button onclick="changeCity('boston')" id="btn-boston" class="flex-1 city-btn py-2 text-[10px] font-bold z-10 uppercase">Boston</button>
            </div>
        </header>
        
        <nav class="menu-grid" id="nav-menu">
            </nav>

        <div id="mode-selector" class="px-6 mt-4" style="display:none;">
            <div class="relative bg-black/30 rounded-full p-1 flex border border-white/10">
                <div id="mode-bg" class="absolute left-1 top-1 bottom-1 w-[calc(50%-4px)] bg-[#FCF6BA] rounded-full transition-all duration-300 z-1"></div>
                <button onclick="setMode('classic')" id="m-classic" class="mode-toggle-btn active uppercase p-2 text-[9px] font-bold flex-1 text-center">Classics</button>
                <button onclick="setMode('new')" id="m-new" class="mode-toggle-btn uppercase p-2 text-[9px] font-bold flex-1 text-center">New Scene</button>
            </div>
        </div>

        <div id="feed" class="flex-1 overflow-y-auto px-5 py-4 space-y-4 no-scrollbar"></div>
    </div>

    <script>
        let state = { city:'nyc', cat:'planner', mode:'classic', isBdayMode: false };
        let clickCount = 0;
        let lastClickTime = 0;

        // Easter Egg Logic
        function handleSecretClick() {
            const now = Date.now();
            if (now - lastClickTime < 500) {
                clickCount++;
            } else {
                clickCount = 1;
            }
            lastClickTime = now;

            if (clickCount === 3) {
                document.getElementById('bday-overlay').style.display = 'flex';
                clickCount = 0;
            }
        }

        const db = [
            // ROMANTIC COUPLE
            { id:300, city:'nyc', cat:'romantic', name:'Private Yacht Sunset', zone:'Hudson River', desc:'Mini crociera privata per due con champagne mentre il sole scompare dietro la Statua della Libert√†.', icon:'fa-ship', price:'$400', rate:'5.0' },
            { id:301, city:'nyc', cat:'romantic', name:'The River Caf√© Table', zone:'DUMBO', desc:'Tavolo d\'angolo garantito. La vista pi√π romantica del mondo sul ponte di Brooklyn.', icon:'fa-wine-glass', price:'$$$$', rate:'4.9' },
            { id:302, city:'boston', cat:'romantic', name:'Gondola on Charles', zone:'Charles River', desc:'Gondola veneziana riscaldata. Un momento magico nel cuore di Boston.', icon:'fa-anchor', price:'$200', rate:'4.8' },
            // SPA & BEAUTY
            { id:100, city:'nyc', cat:'spa', mode:'classic', name:'Aire Ancient Baths', zone:'TriBeCa', desc:'Bagni termali al lume di candela in un edificio del 1883. Massaggio di coppia incluso.', icon:'fa-hot-tub-person', price:'$250+', link:'https://beaire.com' },
            { id:102, city:'nyc', cat:'spa', mode:'classic', name:'Jin Soon Spa', zone:'West Village', desc:'Manicure d\'eccellenza consigliata da Vogue. Per mani impeccabili prima della serata.', icon:'fa-hand-sparkles', price:'$60+' },
            // MUSEI
            { id:1, city:'nyc', cat:'explore', name:'MoMA', zone:'Midtown', icon:'fa-palette', desc:'L\'arte moderna nel suo tempio.', percorsi: {
                p1:{t:'1h - Masterpieces', d:'Le icone: Van Gogh (Notte Stellata) e Monet (Ninfee).'},
                p2:{t:'2h - Oltre l\'Icona', d:'L\'energia del colore: Barnett Newman e Joan Mitchell.'},
                p3:{t:'3h - Tailor Made Design', d:'Dall\'estetica industriale ai computer Apple.'}
            }},
            // FOOD CLASSIC NYC
            { id:20, city:'nyc', cat:'food', mode:'classic', name:'Carbone', zone:'Village', desc:'Lusso anni 50 e rigatoni leggendari.', dish:'Spicy Rigatoni', rate:'4.5', price:'$$$$', link:'https://resy.com/cities/ny/carbone', icon:'fa-utensils' },
            // TIPS
            { id:200, city:'nyc', cat:'tips', name:'Survival Neve', zone:'Logistica', desc:'Se nevica forte, usa la Metro. Il fango di NY rovina le pelli chiare: usa impermeabilizzante.', icon:'fa-snowflake', isAlert:true }
        ];

        function popBottle() {
            document.getElementById('bottle-scene').classList.add('shake');
            document.getElementById('pop-btn').style.display = 'none';
            setTimeout(() => {
                document.getElementById('bottle-scene').classList.remove('shake');
                document.getElementById('bottle-scene').classList.add('pop');
                document.getElementById('bday-msg').classList.remove('opacity-0','translate-y-10');
            }, 1000);
        }

        function exitBday() {
            document.getElementById('bday-overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('bday-overlay').style.display = 'none';
                state.isBdayMode = true;
                renderMenu();
                setCat('romantic');
                changeCity('nyc');
            }, 800);
        }

        function renderMenu() {
            const nav = document.getElementById('nav-menu');
            let items = [
                {id:'planner', icon:'fa-calendar-day', label:'Planner'},
                {id:'explore', icon:'fa-landmark', label:'Musei'},
                {id:'food', icon:'fa-utensils', label:'Food'}
            ];
            if(state.isBdayMode) items.push({id:'romantic', icon:'fa-heart', label:'Couple'});
            items.push({id:'spa', icon:'fa-spa', label:'Beauty'}, {id:'tips', icon:'fa-circle-info', label:'Tips'});

            nav.innerHTML = items.map(i => `<button onclick="setCat('${i.id}')" id="cat-${i.id}" class="cat-chip ${state.cat === i.id ? 'selected' : ''}"><i class="fa-solid ${i.icon}"></i>${i.label}</button>`).join('');
        }

        function changeCity(c) {
            state.city = c;
            document.getElementById('city-bg').style.transform = c === 'nyc' ? 'translateX(0)' : 'translateX(100%)';
            document.querySelectorAll('.bg-layer').forEach(l => l.classList.remove('show-bg'));
            document.getElementById('layer-' + c).classList.add('show-bg');
            updateUI();
        }

        function setCat(c) {
            state.cat = c;
            renderMenu();
            document.getElementById('mode-selector').style.display = (c === 'food' || c === 'spa') ? 'block' : 'none';
            updateUI();
        }

        function setMode(m) {
            state.mode = m;
            document.getElementById('mode-bg').style.left = (m === 'classic') ? '4px' : 'calc(50% + 4px)';
            updateUI();
        }

        function updateUI() {
            const feed = document.getElementById('feed');
            feed.innerHTML = '';
            
            if (state.cat === 'planner') {
                const museums = db.filter(i => i.cat === 'explore' && i.city === state.city);
                feed.innerHTML = `<div class="glass-panel"><h2 class="font-serif text-2xl mb-4 text-[#FCF6BA] italic text-center">Art Concierge</h2><select id="p-sel" class="w-full bg-black/40 p-4 rounded-xl mb-4 text-sm border border-white/10 outline-none text-white">${museums.map(m => `<option value="${m.id}">${m.name}</option>`).join('')}</select><select id="t-sel" class="w-full bg-black/40 p-4 rounded-xl mb-6 text-sm border border-white/10 outline-none text-white"><option value="p1">1 Ora (Masterpieces)</option><option value="p2">2 Ore (Deep Dive)</option><option value="p3">3 Ore (Tailor Made)</option></select><button onclick="calcPlan()" class="w-full py-5 bg-[#FCF6BA] text-[#004D54] font-black rounded-xl text-[10px] uppercase tracking-widest">Genera Narrativa</button><div id="res-box" class="mt-6"></div></div>`;
                return;
            }

            db.filter(i => i.city === state.city && i.cat === state.cat && (['food','spa'].indexOf(state.cat) === -1 || i.mode === state.mode)).forEach(item => {
                const card = document.createElement('div');
                card.className = 'glass-panel flex gap-4 animate-in fade-in duration-500';
                if(item.isAlert) card.style.borderColor = 'var(--c-magenta)';
                card.innerHTML = `<div class="w-12 h-12 shrink-0 bg-white/5 rounded-2xl flex items-center justify-center text-[#FCF6BA] border border-white/10"><i class="fa-solid ${item.icon || 'fa-star'}"></i></div><div class="flex-1"><h4 class="font-black text-white text-md uppercase leading-tight">${item.name}</h4><p class="text-[9px] text-gray-400 uppercase tracking-widest mb-3">${item.zone} ‚Ä¢ ${item.price || ''}</p><p class="text-xs text-gray-300 font-light leading-relaxed">${item.desc}</p>${item.dish ? `<p class="text-[11px] text-[#FCF6BA] mt-3 font-bold">Must: ${item.dish}</p>` : ''}<div class="flex gap-2 mt-4">${item.link ? `<a href="${item.link}" target="_blank" class="flex-1 py-2 border border-[#FCF6BA] text-[#FCF6BA] rounded-lg text-center text-[10px] font-bold uppercase tracking-widest">Reserve</a>` : ''}</div></div>`;
                feed.appendChild(card);
            });
        }

        function calcPlan() {
            const mId = document.getElementById('p-sel').value;
            const routeKey = document.getElementById('t-sel').value;
            const museum = db.find(i => i.id == mId);
            const route = museum.percorsi[routeKey];
            document.getElementById('res-box').innerHTML = `<div class="route-card"><p class="text-[10px] text-[#FCF6BA] font-black uppercase mb-2 tracking-widest">${route.t}</p><p class="text-xs text-gray-200 italic">"${route.d}"</p></div>`;
        }

        // Initialize Menu
        renderMenu();
    </script>
</body>
</html>
